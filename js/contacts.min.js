var map_timer,gmap,center,all_pins=[],all_tooltips=[],offices=[{lt:55.748697,ln:37.609663},{lt:53.22333,ln:50.192732},{lt:53.505992,ln:49.412826},{lt:53.141607,ln:48.442664}],mapProp={zoom:16,scrollwheel:!1,mapTypeControl:!1,scaleControl:!1};function checkMapSize(){clearTimeout(map_timer),map_timer=setTimeout(function(){gmap&&center&&gmap.setCenter(center)},10)}function updateMap(event,link,panel,el){var ind=1*link.attr("data-office")-1;ind<=offices.length&&(center=new google.maps.LatLng(offices[ind].lt,offices[ind].ln),checkMapSize())}function loadMap(){setTimeout(function(){center=new google.maps.LatLng(offices[0].lt,offices[0].ln),(gmap=new google.maps.Map(document.getElementById("contacts_map"),mapProp)).setCenter(center);for(var i=0;i<offices.length;i++){var ofc=offices[i];createPin(gmap,"Альфапром",{lat:ofc.lt,lng:ofc.ln},!1)}},0)}function createPin(target_map,name,latlng,icon,icon_hover,magic_top_offset){var marker,img=new Image;if(!icon||!icon.length)return marker=new google.maps.Marker({position:latlng,map:target_map,title:name}),icon_hover&&icon_hover.length&&(google.maps.event.addListener(marker,"mouseover",function(){}),google.maps.event.addListener(marker,"mouseout",function(){})),marker;$(img).one("load",function(){var image=new google.maps.MarkerImage(icon,new google.maps.Size(img.width,img.height),new google.maps.Point(0,0),new google.maps.Point((img.width/2).toFixed(),img.height+(magic_top_offset||0)));return marker=new google.maps.Marker({position:latlng,map:target_map,icon:image,title:name}),icon_hover&&icon_hover.length&&(google.maps.event.addListener(marker,"mouseover",function(){marker.setIcon(icon_hover)}),google.maps.event.addListener(marker,"mouseout",function(){marker.setIcon(icon)})),marker}),img.src=icon}$(window).on("resize load",function(){checkMapSize()}),$(function($){checkMapSize(),$(".mapBtn").on("click",function(){var firedEl=$(this),ind=1*firedEl.attr("data-office")-1;return ind<=offices.length&&($(".mapBtn").removeClass("active"),firedEl.addClass("active"),center=new google.maps.LatLng(offices[ind].lt,offices[ind].ln),checkMapSize()),!1}).first().click()});